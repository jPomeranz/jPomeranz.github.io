import{r as c,j as e}from"./index-B4-on9eK.js";const y=({isOpen:n,onClose:t,children:o})=>(c.useEffect(()=>{if(!n)return;const a=d=>{d.key==="Escape"&&t()};return document.addEventListener("keydown",a),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",a),document.body.style.overflow="unset"}},[n,t]),n?e.jsx("div",{className:"modal-overlay",onClick:t,children:e.jsxs("div",{className:"modal-content",onClick:a=>a.stopPropagation(),children:[e.jsx("button",{className:"modal-close",onClick:t,children:"×"}),o]})}):null),p=n=>{const t=n.split(" by ");return{title:t[0].trim(),author:t[1]?.trim()||""}},w=()=>{const[n,t]=c.useState([]),[o,a]=c.useState(null),[d,h]=c.useState(!1),[u,m]=c.useState(null);c.useEffect(()=>{(async()=>{const r=await(await fetch("/books.txt")).text();t(r.split(`
`).filter(s=>s.trim()))})()},[]);const f=async(i,l)=>{const r=`intitle:${encodeURIComponent(i)}${l?`+inauthor:${encodeURIComponent(l)}`:""}`,s=await fetch(`https://www.googleapis.com/books/v1/volumes?q=${r}&maxResults=1`);if(!s.ok)throw s.status===429?new Error("Rate limited by Google Books API. Please try again later."):new Error(`API error: ${s.status}`);return(await s.json()).items?.[0]?.volumeInfo||null},b=async i=>{const{title:l,author:r}=p(i);h(!0),m(null);try{const s=await f(l,r);s?a(s):m("Book information not found")}catch(s){const k=s instanceof Error?s.message:String(s);m(`Failed to fetch book information: ${k}`)}finally{h(!1)}},x=()=>{a(null),m(null)},j=d||!!u||!!o,g=d?e.jsx("div",{className:"loading",children:"Loading book information..."}):u?e.jsx("div",{className:"error-message",children:u}):o?e.jsxs("div",{className:"modal-body",children:[o.imageLinks?.thumbnail&&e.jsx("img",{src:o.imageLinks.thumbnail.startsWith("http:")?o.imageLinks.thumbnail.replace(/^http:/,"https:"):o.imageLinks.thumbnail,alt:o.title,className:"book-thumbnail"}),e.jsxs("div",{className:"book-details",children:[e.jsx("h2",{children:o.title}),o.authors&&e.jsxs("p",{className:"book-authors",children:["by ",o.authors.join(", ")]}),o.description&&e.jsx("p",{className:"book-description",children:o.description}),o.infoLink&&e.jsx("a",{href:o.infoLink,target:"_blank",rel:"noopener noreferrer",className:"view-link",children:"View on Google Books →"})]})]}):null;return e.jsxs("div",{className:"books-page",children:[e.jsx("div",{className:"container",style:{marginTop:"2em",marginLeft:"0.5em"},children:e.jsx("h1",{children:"Books"})}),e.jsx("ul",{className:"books-list",children:n.map((i,l)=>{const{title:r,author:s}=p(i);return e.jsxs("li",{className:"book-item",onClick:()=>b(i),children:[e.jsx("span",{className:"book-title",children:r}),s&&e.jsxs("span",{className:"book-author",children:["by ",s]})]},l)})}),e.jsx(y,{isOpen:j,onClose:x,children:g})]})};export{w as default};
